<!-- Artists Hero Section -->
<section class="hero" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 3rem 0; color: white; text-align: center;">
    <div class="container">
        <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">Talented Artists</h1>
        <p style="font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto;">
            Discover amazing artists from around the world and explore their unique creative journeys
        </p>
    </div>
</section>

<!-- Artists Filter & Search -->
<section class="container" style="margin-top: 2rem;">
    <div class="card">
        <div style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: center; justify-content: space-between;">
            <div style="flex: 1; min-width: 300px;">
                <div class="search-box">
                    <input type="text" id="artist-search" placeholder="Search artists by name, city, or district..." style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 25px; font-size: 1rem;">
                    <i class="fas fa-search" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #999;"></i>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <select id="location-filter" style="padding: 0.75rem; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; min-width: 120px;">
                    <option value="">All Locations</option>
                    <option value="kathmandu">Kathmandu</option>
                    <option value="lalitpur">Lalitpur</option>
                    <option value="bhaktapur">Bhaktapur</option>
                    <option value="pokhara">Pokhara</option>
                    <option value="chitwan">Chitwan</option>
                    <option value="dharan">Dharan</option>
                </select>
                
                <select id="sort-filter" style="padding: 0.75rem; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; min-width: 120px;">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="name">Name A-Z</option>
                    <option value="name_desc">Name Z-A</option>
                </select>
            </div>
        </div>
    </div>
</section>

<!-- Artists Stats -->
<section class="container">
    <div class="card">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: center;">
            <div>
                <h3 style="font-size: 2rem; color: #667eea; margin-bottom: 0.5rem;"><%= stats.totalArtists %></h3>
                <p style="color: #666; font-size: 1rem;">Total Artists</p>
            </div>
            <div>
                <h3 style="font-size: 2rem; color: #764ba2; margin-bottom: 0.5rem;"><%= stats.totalArtworks %></h3>
                <p style="color: #666; font-size: 1rem;">Total Artworks</p>
            </div>
            <div>
                <h3 style="font-size: 2rem; color: #f093fb; margin-bottom: 0.5rem;"><%= stats.avgAge %></h3>
                <p style="color: #666; font-size: 1rem;">Average Age</p>
            </div>
            <div>
                <h3 style="font-size: 2rem; color: #43e97b; margin-bottom: 0.5rem;"><%= stats.locations %></h3>
                <p style="color: #666; font-size: 1rem;">Different Cities</p>
            </div>
        </div>
    </div>
</section>

<!-- Loading Indicator -->
<div id="loading-indicator" style="display: none; text-align: center; padding: 2rem;">
    <div class="loading"></div>
    <p style="margin-top: 1rem; color: #666;">Loading artists...</p>
</div>

<!-- Artists Grid -->
<section class="container">
    <div id="artists-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 2rem;">
        <% artists.forEach(artist => { %>
            <div class="artist-card" data-name="<%= artist.full_name.toLowerCase() %>" data-city="<%= artist.city.toLowerCase() %>" data-district="<%= artist.district.toLowerCase() %>">
                <div class="card" style="height: 100%; transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 30px rgba(0,0,0,0.1)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 10px rgba(0,0,0,0.1)';">
                    <!-- Profile Picture -->
                    <div style="position: relative; overflow: hidden; border-radius: 10px 10px 0 0; height: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <% if (artist.profile_picture) { %>
                            <img src="/uploads/<%= artist.profile_picture %>" 
                                 alt="<%= artist.full_name %>"
                                 style="width: 100%; height: 100%; object-fit: cover;"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div class="artist-placeholder" style="display: none; align-items: center; justify-content: center; height: 100%; color: white; font-size: 3rem;">
                                <i class="fas fa-user"></i>
                            </div>
                        <% } else { %>
                            <div class="artist-placeholder" style="display: flex; align-items: center; justify-content: center; height: 100%; color: white; font-size: 3rem;">
                                <i class="fas fa-user"></i>
                            </div>
                        <% } %>
                        
                        <!-- Artist Badge -->
                        <div style="position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.9); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem; font-weight: bold; color: #667eea;">
                            Artist
                        </div>
                    </div>

                    <!-- Artist Info -->
                    <div style="padding: 1.5rem;">
                        <h3 style="margin: 0 0 0.5rem 0; color: #333; font-size: 1.2rem;">
                            <a href="/artists/<%= artist.id %>" style="text-decoration: none; color: inherit;" 
                               onmouseover="this.style.color='#667eea'" onmouseout="this.style.color='inherit'">
                                <%= artist.full_name %>
                            </a>
                        </h3>
                        
                        <div style="display: flex; align-items: center; margin-bottom: 0.5rem; color: #666; font-size: 0.9rem;">
                            <i class="fas fa-map-marker-alt" style="margin-right: 0.5rem; color: #667eea;"></i>
                            <%= artist.city %>, <%= artist.district %>
                        </div>
                        
                        <div style="display: flex; align-items: center; margin-bottom: 1rem; color: #666; font-size: 0.9rem;">
                            <i class="fas fa-birthday-cake" style="margin-right: 0.5rem; color: #667eea;"></i>
                            <%= artist.age %> years old
                        </div>

                        <!-- Bio Preview -->
                        <% if (artist.bio) { %>
                            <p style="color: #555; font-size: 0.9rem; line-height: 1.4; margin-bottom: 1rem; display: -webkit-box; -webkit-line-clamp: 3; line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                <%= artist.bio.substring(0, 120) %><%= artist.bio.length > 120 ? '...' : '' %>
                            </p>
                        <% } %>

                        <!-- Social Links -->
                        <% if (artist.socials) { %>
                            <% const socials = JSON.parse(artist.socials) %>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                <% if (socials.instagram) { %>
                                    <a href="<%= socials.instagram %>" target="_blank" style="color: #E4405F; font-size: 1.2rem;" title="Instagram">
                                        <i class="fab fa-instagram"></i>
                                    </a>
                                <% } %>
                                <% if (socials.facebook) { %>
                                    <a href="<%= socials.facebook %>" target="_blank" style="color: #1877F2; font-size: 1.2rem;" title="Facebook">
                                        <i class="fab fa-facebook"></i>
                                    </a>
                                <% } %>
                                <% if (socials.twitter) { %>
                                    <a href="<%= socials.twitter %>" target="_blank" style="color: #1DA1F2; font-size: 1.2rem;" title="Twitter">
                                        <i class="fab fa-twitter"></i>
                                    </a>
                                <% } %>
                                <% if (socials.youtube) { %>
                                    <a href="<%= socials.youtube %>" target="_blank" style="color: #FF0000; font-size: 1.2rem;" title="YouTube">
                                        <i class="fab fa-youtube"></i>
                                    </a>
                                <% } %>
                                <% if (socials.tiktok) { %>
                                    <a href="<%= socials.tiktok %>" target="_blank" style="color: #000; font-size: 1.2rem;" title="TikTok">
                                        <i class="fab fa-tiktok"></i>
                                    </a>
                                <% } %>
                            </div>
                        <% } %>

                        <!-- Art Started -->
                        <% if (artist.started_art_at) { %>
                            <div style="background: #f8f9ff; padding: 0.75rem; border-radius: 5px; margin-bottom: 1rem;">
                                <small style="color: #667eea; font-weight: bold;">Started Art:</small>
                                <small style="color: #555; display: block; margin-top: 0.25rem;"><%= artist.started_art_at %></small>
                            </div>
                        <% } %>

                        <!-- View Profile Button -->
                        <a href="/artists/<%= artist.id %>" class="btn btn-outline" style="width: 100%; text-align: center; text-decoration: none;">
                            View Profile & Artworks
                        </a>
                    </div>
                </div>
            </div>
        <% }) %>
    </div>
</section>

<!-- No Artists Found -->
<div id="no-artists" style="display: none; text-align: center; padding: 3rem;">
    <div style="font-size: 4rem; color: #ddd; margin-bottom: 1rem;">
        <i class="fas fa-search"></i>
    </div>
    <h3 style="color: #666; margin-bottom: 1rem;">No Artists Found</h3>
    <p style="color: #999;">Try adjusting your search criteria or filters.</p>
</div>

<!-- Pagination -->
<% if (pagination && pagination.totalPages > 1) { %>
<section class="container">
    <div style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin: 2rem 0;">
        <% if (pagination.currentPage > 1) { %>
            <a href="?page=<%= pagination.currentPage - 1 %>" class="btn btn-outline" style="text-decoration: none;">
                <i class="fas fa-chevron-left"></i> Previous
            </a>
        <% } %>
        
        <div style="display: flex; gap: 0.5rem; align-items: center;">
            <% for (let i = Math.max(1, pagination.currentPage - 2); i <= Math.min(pagination.totalPages, pagination.currentPage + 2); i++) { %>
                <a href="?page=<%= i %>" 
                   class="<%= i === pagination.currentPage ? 'btn' : 'btn btn-outline' %>" 
                   style="text-decoration: none; min-width: 40px; text-align: center;">
                    <%= i %>
                </a>
            <% } %>
        </div>
        
        <% if (pagination.currentPage < pagination.totalPages) { %>
            <a href="?page=<%= pagination.currentPage + 1 %>" class="btn btn-outline" style="text-decoration: none;">
                Next <i class="fas fa-chevron-right"></i>
            </a>
        <% } %>
    </div>
    
    <div style="text-align: center; color: #666; font-size: 0.9rem;">
        Showing <%= (pagination.currentPage - 1) * pagination.limit + 1 %> - 
        <%= Math.min(pagination.currentPage * pagination.limit, pagination.totalItems) %> of 
        <%= pagination.totalItems %> artists
    </div>
</section>
<% } %>

<script>
    // Search and filter functionality
    let searchTimeout;
    
    document.getElementById('artist-search').addEventListener('input', function() {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(filterArtists, 300);
    });
    
    document.getElementById('location-filter').addEventListener('change', filterArtists);
    document.getElementById('sort-filter').addEventListener('change', filterArtists);
    
    function filterArtists() {
        const searchTerm = document.getElementById('artist-search').value.toLowerCase();
        const locationFilter = document.getElementById('location-filter').value.toLowerCase();
        const sortFilter = document.getElementById('sort-filter').value;
        
        const artistCards = Array.from(document.querySelectorAll('.artist-card'));
        let visibleCards = [];
        
        // Filter artists
        artistCards.forEach(card => {
            const name = card.dataset.name;
            const city = card.dataset.city;
            const district = card.dataset.district;
            
            const matchesSearch = !searchTerm || 
                name.includes(searchTerm) || 
                city.includes(searchTerm) || 
                district.includes(searchTerm);
            
            const matchesLocation = !locationFilter || 
                city.includes(locationFilter) || 
                district.includes(locationFilter);
            
            if (matchesSearch && matchesLocation) {
                card.style.display = 'block';
                visibleCards.push(card);
            } else {
                card.style.display = 'none';
            }
        });
        
        // Sort visible cards
        if (sortFilter && visibleCards.length > 0) {
            const grid = document.getElementById('artists-grid');
            
            visibleCards.sort((a, b) => {
                switch (sortFilter) {
                    case 'name':
                        return a.dataset.name.localeCompare(b.dataset.name);
                    case 'name_desc':
                        return b.dataset.name.localeCompare(a.dataset.name);
                    case 'newest':
                        // Assuming cards are already in newest first order
                        return 0;
                    case 'oldest':
                        // Reverse the order
                        return 0;
                    default:
                        return 0;
                }
            });
            
            // Reorder in DOM
            visibleCards.forEach(card => grid.appendChild(card));
        }
        
        // Show/hide no results message
        const noArtists = document.getElementById('no-artists');
        if (visibleCards.length === 0) {
            noArtists.style.display = 'block';
        } else {
            noArtists.style.display = 'none';
        }
    }
    
    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        // Add smooth scroll to artist cards
        const artistCards = document.querySelectorAll('.artist-card');
        artistCards.forEach((card, index) => {
            card.style.animationDelay = (index * 0.1) + 's';
            card.style.animation = 'fadeInUp 0.6s ease forwards';
        });
    });
    
    // Add CSS animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .artist-card {
            opacity: 0;
        }
        
        .search-box {
            position: relative;
        }
        
        .loading {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;
    document.head.appendChild(style);
</script>
