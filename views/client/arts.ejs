<!-- Arts Hero Section -->
<section class="hero" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 3rem 0; color: white; text-align: center;">
    <div class="container">
        <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">Discover Amazing Artworks</h1>
        <p style="font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto;">
            Explore unique pieces from talented artists around the world
        </p>
    </div>
</section>

<!-- Arts Filter & Search -->
<section class="container" style="margin-top: 2rem;">
    <div class="card">
        <div style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: center; justify-content: space-between;">
            <div style="flex: 1; min-width: 300px;">
                <div class="search-box">
                    <input type="text" id="art-search" placeholder="Search artworks by title, artist, or description..." style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 25px; font-size: 1rem;">
                    <i class="fas fa-search" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #999;"></i>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <select id="status-filter" style="padding: 0.75rem; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; min-width: 120px;">
                    <option value="">All Status</option>
                    <option value="available">Available</option>
                    <option value="sold">Sold</option>
                    <option value="reserved">Reserved</option>
                </select>
                
                <select id="price-filter" style="padding: 0.75rem; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; min-width: 120px;">
                    <option value="">All Prices</option>
                    <option value="0-5000">Under रू 5,000</option>
                    <option value="5000-15000">रू 5,000 - 15,000</option>
                    <option value="15000-50000">रू 15,000 - 50,000</option>
                    <option value="50000-999999">Above रू 50,000</option>
                </select>
                
                <select id="sort-filter" style="padding: 0.75rem; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; min-width: 120px;">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="price_low">Price: Low to High</option>
                    <option value="price_high">Price: High to Low</option>
                    <option value="title">Title A-Z</option>
                </select>
            </div>
        </div>
    </div>
</section>

<!-- Arts Stats -->
<section class="container">
    <div class="card">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: center;">
            <div>
                <h3 style="font-size: 2rem; color: #667eea; margin-bottom: 0.5rem;"><%= stats.totalArts %></h3>
                <p style="color: #666; font-size: 1rem;">Total Artworks</p>
            </div>
            <div>
                <h3 style="font-size: 2rem; color: #43e97b; margin-bottom: 0.5rem;"><%= stats.available %></h3>
                <p style="color: #666; font-size: 1rem;">Available</p>
            </div>
            <div>
                <h3 style="font-size: 2rem; color: #e74c3c; margin-bottom: 0.5rem;"><%= stats.sold %></h3>
                <p style="color: #666; font-size: 1rem;">Sold</p>
            </div>
            <div>
                <h3 style="font-size: 2rem; color: #f093fb; margin-bottom: 0.5rem;">रू <%= stats.avgPrice.toLocaleString() %></h3>
                <p style="color: #666; font-size: 1rem;">Average Price</p>
            </div>
        </div>
    </div>
</section>

<!-- Loading Indicator -->
<div id="loading-indicator" style="display: none; text-align: center; padding: 2rem;">
    <div class="loading"></div>
    <p style="margin-top: 1rem; color: #666;">Loading artworks...</p>
</div>

<!-- Arts Grid -->
<section class="container">
    <div id="arts-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem;">
        <% arts.forEach(art => { %>
            <div class="art-card" 
                 data-title="<%= art.title.toLowerCase() %>" 
                 data-artist="<%= art.artist_name.toLowerCase() %>" 
                 data-description="<%= (art.description || '').toLowerCase() %>"
                 data-price="<%= art.price %>" 
                 data-status="<%= art.status %>"
                 data-date="<%= art.created_at %>">
                <div class="card" style="height: 100%; transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 15px 40px rgba(0,0,0,0.1)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 10px rgba(0,0,0,0.1)';">
                    <!-- Artwork Image -->
                    <div style="position: relative; overflow: hidden; border-radius: 10px 10px 0 0; height: 250px; background: #f5f5f5;">
                        <% if (art.image) { %>
                            <img src="/uploads/<%= art.image %>" 
                                 alt="<%= art.title %>"
                                 style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;"
                                 onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <% } else { %>
                            <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #999; font-size: 3rem;">
                                <i class="fas fa-image"></i>
                            </div>
                        <% } %>
                        
                        <!-- Status Badge -->
                        <div class="status-badge" data-status="<%= art.status %>" style="position: absolute; top: 15px; left: 15px; color: white; padding: 0.4rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: bold; text-transform: capitalize; backdrop-filter: blur(10px);">
                            <%= art.status %>
                        </div>
                        
                        <!-- Price Badge -->
                        <div style="position: absolute; bottom: 15px; right: 15px; background: rgba(0,0,0,0.8); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-weight: bold; backdrop-filter: blur(10px);">
                            रू <%= art.price.toLocaleString() %>
                        </div>

                        <!-- Quick View Button -->
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s ease;" class="quick-view-btn">
                            <a href="/arts/<%= art.id %>" style="background: rgba(255,255,255,0.95); color: #667eea; padding: 0.75rem 1.5rem; border-radius: 25px; text-decoration: none; font-weight: bold; backdrop-filter: blur(10px);">
                                <i class="fas fa-eye" style="margin-right: 0.5rem;"></i>
                                Quick View
                            </a>
                        </div>
                    </div>

                    <!-- Artwork Info -->
                    <div style="padding: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                            <h3 style="margin: 0; color: #333; font-size: 1.2rem; flex: 1;">
                                <a href="/arts/<%= art.id %>" style="text-decoration: none; color: inherit;" 
                                   onmouseover="this.style.color='#667eea'" onmouseout="this.style.color='inherit'">
                                    <%= art.title %>
                                </a>
                            </h3>
                            
                            <% if (art.status === 'available') { %>
                                <button class="add-to-cart-btn" data-artwork-id="<%= art.id %>" style="background: none; border: none; color: #667eea; font-size: 1.2rem; cursor: pointer; padding: 0.25rem;" title="Add to Cart">
                                    <i class="fas fa-heart"></i>
                                </button>
                            <% } %>
                        </div>
                        
                        <div style="display: flex; align-items: center; margin-bottom: 0.75rem; color: #666; font-size: 0.95rem;">
                            <i class="fas fa-user" style="margin-right: 0.5rem; color: #667eea;"></i>
                            <a href="/artists/<%= art.artist_id %>" style="text-decoration: none; color: inherit;" 
                               onmouseover="this.style.color='#667eea'" onmouseout="this.style.color='inherit'">
                                <%= art.artist_name %>
                            </a>
                        </div>
                        
                        <% if (art.description) { %>
                            <p style="color: #555; font-size: 0.9rem; line-height: 1.5; margin-bottom: 1rem; display: -webkit-box; -webkit-line-clamp: 3; line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                <%= art.description.substring(0, 120) %><%= art.description.length > 120 ? '...' : '' %>
                            </p>
                        <% } %>

                        <!-- Action Buttons -->
                        <div style="display: flex; gap: 0.75rem; margin-top: 1rem;">
                            <a href="/arts/<%= art.id %>" class="btn btn-outline" style="flex: 1; text-align: center; text-decoration: none; font-size: 0.9rem;">
                                <i class="fas fa-eye" style="margin-right: 0.25rem;"></i>
                                View Details
                            </a>
                            
                            <% if (art.status === 'available') { %>
                                <button class="add-to-cart-main-btn" data-artwork-id="<%= art.id %>" class="btn" style="flex: 1; font-size: 0.9rem;">
                                    <i class="fas fa-shopping-cart" style="margin-right: 0.25rem;"></i>
                                    Add to Cart
                                </button>
                            <% } else { %>
                                <span style="flex: 1; text-align: center; color: #999; font-size: 0.9rem; font-style: italic; padding: 0.5rem;">
                                    <%= art.status === 'sold' ? 'Sold Out' : 'Not Available' %>
                                </span>
                            <% } %>
                        </div>

                        <!-- Creation Date -->
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #eee; color: #999; font-size: 0.85rem; text-align: center;">
                            Added <%= new Date(art.created_at).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }) %>
                        </div>
                    </div>
                </div>
            </div>
        <% }) %>
    </div>
</section>

<!-- No Arts Found -->
<div id="no-arts" style="display: none; text-align: center; padding: 3rem;">
    <div style="font-size: 4rem; color: #ddd; margin-bottom: 1rem;">
        <i class="fas fa-search"></i>
    </div>
    <h3 style="color: #666; margin-bottom: 1rem;">No Artworks Found</h3>
    <p style="color: #999;">Try adjusting your search criteria or filters.</p>
    <a href="/arts" class="btn btn-outline" style="margin-top: 1rem; text-decoration: none;">
        <i class="fas fa-refresh" style="margin-right: 0.5rem;"></i>
        Clear Filters
    </a>
</div>

<!-- Pagination -->
<% if (pagination && pagination.totalPages > 1) { %>
<section class="container">
    <div style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin: 2rem 0;">
        <% if (pagination.currentPage > 1) { %>
            <a href="?page=<%= pagination.currentPage - 1 %>" class="btn btn-outline" style="text-decoration: none;">
                <i class="fas fa-chevron-left"></i> Previous
            </a>
        <% } %>
        
        <div style="display: flex; gap: 0.5rem; align-items: center;">
            <% for (let i = Math.max(1, pagination.currentPage - 2); i <= Math.min(pagination.totalPages, pagination.currentPage + 2); i++) { %>
                <a href="?page=<%= i %>" 
                   class="<%= i === pagination.currentPage ? 'btn' : 'btn btn-outline' %>" 
                   style="text-decoration: none; min-width: 40px; text-align: center;">
                    <%= i %>
                </a>
            <% } %>
        </div>
        
        <% if (pagination.currentPage < pagination.totalPages) { %>
            <a href="?page=<%= pagination.currentPage + 1 %>" class="btn btn-outline" style="text-decoration: none;">
                Next <i class="fas fa-chevron-right"></i>
            </a>
        <% } %>
    </div>
    
    <div style="text-align: center; color: #666; font-size: 0.9rem;">
        Showing <%= (pagination.currentPage - 1) * pagination.limit + 1 %> - 
        <%= Math.min(pagination.currentPage * pagination.limit, pagination.totalItems) %> of 
        <%= pagination.totalItems %> artworks
    </div>
</section>
<% } %>

<!-- Back to Top Button -->
<button id="back-to-top" style="display: none; position: fixed; bottom: 2rem; right: 2rem; background: #667eea; color: white; border: none; padding: 1rem; border-radius: 50%; font-size: 1.2rem; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); z-index: 1000; transition: all 0.3s ease;">
    <i class="fas fa-arrow-up"></i>
</button>

<script>
    // Search and filter functionality
    let searchTimeout;
    
    document.getElementById('art-search').addEventListener('input', function() {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(filterArts, 300);
    });
    
    document.getElementById('status-filter').addEventListener('change', filterArts);
    document.getElementById('price-filter').addEventListener('change', filterArts);
    document.getElementById('sort-filter').addEventListener('change', filterArts);
    
    function filterArts() {
        const searchTerm = document.getElementById('art-search').value.toLowerCase();
        const statusFilter = document.getElementById('status-filter').value.toLowerCase();
        const priceFilter = document.getElementById('price-filter').value;
        const sortFilter = document.getElementById('sort-filter').value;
        
        const artCards = Array.from(document.querySelectorAll('.art-card'));
        let visibleCards = [];
        
        // Filter arts
        artCards.forEach(card => {
            const title = card.dataset.title;
            const artist = card.dataset.artist;
            const description = card.dataset.description;
            const price = parseFloat(card.dataset.price);
            const status = card.dataset.status;
            
            // Search filter
            const matchesSearch = !searchTerm || 
                title.includes(searchTerm) || 
                artist.includes(searchTerm) || 
                description.includes(searchTerm);
            
            // Status filter
            const matchesStatus = !statusFilter || status === statusFilter;
            
            // Price filter
            let matchesPrice = true;
            if (priceFilter) {
                const [min, max] = priceFilter.split('-').map(Number);
                matchesPrice = price >= min && price <= max;
            }
            
            if (matchesSearch && matchesStatus && matchesPrice) {
                card.style.display = 'block';
                visibleCards.push(card);
            } else {
                card.style.display = 'none';
            }
        });
        
        // Sort visible cards
        if (sortFilter && visibleCards.length > 0) {
            const grid = document.getElementById('arts-grid');
            
            visibleCards.sort((a, b) => {
                switch (sortFilter) {
                    case 'title':
                        return a.dataset.title.localeCompare(b.dataset.title);
                    case 'price_low':
                        return parseFloat(a.dataset.price) - parseFloat(b.dataset.price);
                    case 'price_high':
                        return parseFloat(b.dataset.price) - parseFloat(a.dataset.price);
                    case 'newest':
                        return new Date(b.dataset.date) - new Date(a.dataset.date);
                    case 'oldest':
                        return new Date(a.dataset.date) - new Date(b.dataset.date);
                    default:
                        return 0;
                }
            });
            
            // Reorder in DOM
            visibleCards.forEach(card => grid.appendChild(card));
        }
        
        // Show/hide no results message
        const noArts = document.getElementById('no-arts');
        if (visibleCards.length === 0) {
            noArts.style.display = 'block';
        } else {
            noArts.style.display = 'none';
        }
    }
    
    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        // Set status badge colors
        document.querySelectorAll('.status-badge').forEach(badge => {
            const status = badge.dataset.status;
            if (status === 'available') {
                badge.style.background = 'rgba(67, 233, 123, 0.9)';
            } else if (status === 'sold') {
                badge.style.background = 'rgba(231, 76, 60, 0.9)';
            } else {
                badge.style.background = 'rgba(243, 156, 18, 0.9)';
            }
        });
        
        // Add to cart button functionality
        document.querySelectorAll('.add-to-cart-btn, .add-to-cart-main-btn').forEach(button => {
            button.addEventListener('click', function() {
                const artworkId = this.dataset.artworkId;
                window.cart.addItem(artworkId);
            });
        });
        
        // Quick view button show/hide
        document.querySelectorAll('.art-card').forEach(card => {
            const quickViewBtn = card.querySelector('.quick-view-btn');
            card.addEventListener('mouseenter', () => {
                if (quickViewBtn) quickViewBtn.style.opacity = '1';
            });
            card.addEventListener('mouseleave', () => {
                if (quickViewBtn) quickViewBtn.style.opacity = '0';
            });
        });
        
        // Back to top button
        const backToTopBtn = document.getElementById('back-to-top');
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.style.display = 'block';
            } else {
                backToTopBtn.style.display = 'none';
            }
        });
        
        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // Add smooth scroll animation for art cards
        const artCards = document.querySelectorAll('.art-card');
        artCards.forEach((card, index) => {
            card.style.animationDelay = (index * 0.1) + 's';
            card.style.animation = 'fadeInUp 0.6s ease forwards';
        });
    });
    
    // Add CSS animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .art-card {
            opacity: 0;
        }
        
        .search-box {
            position: relative;
        }
        
        .loading {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .art-card:hover .quick-view-btn {
            opacity: 1 !important;
        }
        
        #back-to-top:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
    `;
    document.head.appendChild(style);
</script>
